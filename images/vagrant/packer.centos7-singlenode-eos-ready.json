{
  "builders": [
    {
      "type"                : "vagrant",
      "provider"            : "virtualbox",
      "source_path"         : "{{template_dir}}/../../.boxes/centos7-singlenode-eos-deployed/package.box",
      "add_force"           : true,
      "box_name"            : "seagate.ees-prvsnr.centos7-singlenode-eos-deployed",
      "template"            : "{{template_dir}}/vagrantfile.eos.packer.template",
      "output_dir"          : "{{template_dir}}/../../.boxes/centos7-singlenode-eos-ready",
      "output_vagrantfile"  : "{{template_dir}}/vagrantfile.eos.boxed",
      "package_include"     : [
          "{{template_dir}}/../../test/id_rsa.test"
      ],
      "communicator"        : "ssh"
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": [
        "cd /tmp/ees-prvsnr/cli/src",
        "chmod u+x bootstrap-eos start-eos",
        "set -o pipefail",
        "hostname eosnode-1",
        "./bootstrap-eos -vv -S 2>&1 | tee /tmp/bootstrap-eos.logs",
        "./start-eos -vv -S 2>&1 | tee /tmp/start-eos.logs"
      ]
    }
  ]
}
